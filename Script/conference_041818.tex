\documentclass[conference]{IEEEtran}
\IEEEoverridecommandlockouts
% The preceding line is only needed to identify funding in the first footnote. If that is unneeded, please comment it out.
\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{xcolor}

% For fig
\usepackage{physics}
\usepackage{amsmath}
\usepackage{tikz}
\usepackage{mathdots}
\usepackage{yhmath}
\usepackage{cancel}
\usepackage{color}
\usepackage{siunitx}
\usepackage{array}
\usepackage{multirow}
\usepackage{amssymb}
\usepackage{gensymb}
\usepackage{tabularx}
\usepackage{booktabs}
\usetikzlibrary{fadings}
\usetikzlibrary{patterns}
\usetikzlibrary{shadows.blur}
\usetikzlibrary{shapes}

\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\begin{document}

\title{LSTM-based Beam Tracking for mmWave Vehicular Networks\\
}

\author{\IEEEauthorblockN{Chen Wang, XXX, XXX, XXX}
\IEEEauthorblockA{\textit{Beijing Key Laboratory of Network System Architecture and Convergence, Beijing University of Posts and Telecommunications} \\
Beijing, China \\
wangchen@bupt.edu.cn}
}

\maketitle

\begin{abstract}
The use of millimeter wave (mmWave) frequency bands for transmission can improve data rate with the help of beamforming technology to overcome the high path and penetration losses.
However for vehicle, the high mobility of vehicle results in extremely frequent beam alignment and significant overhead.
In this paper, a Long Short Time Memory (LSTM)-based beam tracking method was proposed for reducing overhead brought by beam alignment in mmWave Vehicular Networks, by predicting angles of beam pair at next time step through known angles of beam pairs at a certain number of consecutive time steps as features.
To train this network, an time series array antenna channel data was set up by statistical channel model using time series vehicle information generated from road traffic simulation software named ``Simulation of Urban MObility (SUMO)''.
%% In addition, a extended Kalman filter (EKF) based method using vehicle information to estimate predicted beam angle was adopted as comparison method.
Simulation results show that proposed LSTM-based method outpreforms Kalman filter based method, and can prevent frequent beam alignment to reduce overhead while ensuring acceptable signal-to-noise ratio (SNR).
\end{abstract}

\begin{IEEEkeywords}
beam tracking, mmWave vehicular networks, LSTM, Kalman filter
\end{IEEEkeywords}

\section{Introduction}
% 毫米波依靠丰富的频谱资源，可以有效提高传输速率，是通信未来发展的重要技术之一 *。
MmWave is one of the important technology for the future development of communications \cite{Niu2015}, relies on abundant spectrum resources.
% 为了更好地应用的毫米波，需要克服毫米波高频导致的极高的路径和穿透损耗 *。
In order to apply mmWave better, the high path and penetration loss caused by high frequency of mmWave need to be overcome \cite{Zhao2013}.
% 得益于毫米波毫米级的波长，可能将阵列天线集成进终端，并使用阵列天线的波束赋形技术，将天线能量约束在指定方向，获取高增益 *。
Thanks to the small wavelength of mmWave, it is possible to integrate the array antenna into the terminal and use the beamforming technique to constrained signal power in specified direction for high gain \cite{Heath2016}.
% 论文 * 提出了数字波束赋形技术，然而由于射频链的高价格和高能耗，给天线阵列中的每一根天线都配置射频链的成本是不可接受的 *。
% 目前较多的研究主要集中在基于量化相移器的单射频链模拟波束赋形 *，和使用较少射频链的混合波束赋形 * 折中方案上。

% 不同于传统全向天线，阵列天线的信道具有方向性 *，这意味着若想形成较高的波束增益，必须保证接收端和发送端的波束之间相互对准，否则波束对的失准将会带来严重的增益下降，降低通信性能。
Unlike conventional omni-directional antennas, array antennas are directional \cite{Giordani2019}, which means that if higher antenna gain needs to be achieved, it is important to ensure that the beams generated by array antennas at the receiver and transmitter are aligned with each other. Otherwise the misalignment of the beam pairs will result in serious gain reduction, degrading communications performance.
% 研究 * 提出了一种分级码本的设计，本质是采用了二分查找的方式，在不同阶段使用不同宽度的波束进行波束扫描并获得最佳波束对，以此减少开支。
A hierarchical codebook design was proposed in \cite{Noh2017}, which essentially exploit binary search algorithm to reduce overhead by using different widths of beams at different stages to perform beam search.
% 然而，这种算法需要量化相移器具有较高的量化水平，并且有可能需要多个射频链来实现，这导致采用这种算法方案的成本极高。
However, this algorithm requires a high quantization level phase shifter and potentially multiple RF chains to implement, which results in high cost.
% 对此，* 提出了一种基于卡尔曼滤波器使用穷尽扫描进行波束追踪的方案，以减少系统的开支，然而穷尽扫描所需要的测量次数和协议开支会随着天线数的增加而增加。
In \cite{Zhang2016}, Zhang et al. proposed a Kalman filter based method for beam tracking using exhaustive search. However, the number of measurements and protocol overhead for exhaustive search required increases with the number of antennas.
% * 在此基础上加以改进采用 EKF，并且只需要单次测量，更适用于在快速变换环境下的信道追踪。
On the other hand, \cite{Va2017} exploits extended Kalman filter and requires only a single measurement, making it more suitable for beam tracking in fast-changing environments.

% 相较于低速的用户终端，为高速车辆提供可靠的波束对准更具挑战性，因为车辆较高的速度将会导致车辆更快驶出波束的覆盖范围。
Providing reliable beam alignment for high speed vehicles is more challenging than for low speed terminals, due to vehicles move out of the beam coverage faster. 
%为了保证车辆始终被较高增益的波束覆盖，需要进行高频率的对准，而高频的波束会进一步加大系统的开支，尤其是当采用高分辨率码本的时候。
To ensure that the vehicles are always covered by high gain beams, high frequency beam alignment is required, and it can further increase system overhead, especially when high resolution code books are used.
% 幸运的是，由于毫米波信道的稀疏性 *，且毫米波信道的 AoA、AoD 与收发端位置的具有一定的相关性 *，在 LOS 信号下沿固定道路行驶的车辆的 AoA 和 AoD 应该能被很好的预测出来。
Fortunately, due to the sparsity of mmWave channel \cite{Lee2014} and the correlation between the angle of arrival (AoA) and angle of departure (AoD) of a millimeter-wave channel and the location of the receiver and transmitter \cite{Aviles2016}, the angle of beam pair of a vehicle traveling along a fixed road under LOS condition should be well predicted.

% 本文提出了一种基于 LSTM 网络的波束追踪方法，使用 LSTM 网络，通过对历史车辆穷尽扫描所获得的历史信道信息进行学习，根据当前车辆在一定时间步的信道信息，预测在下一时刻的 AoA 和 AoD，以达到减少系统开支的效果。
In this paper, a LSTM-based beam tracking method is proposed. By using LSTM network to learn the historical channel state information (CSI) which was obtained from exhausted beam search, AoA and AoD of current channel between vehicle and BS can be predicted to reduce system overhead.
% 同时，为了获取信道数据用以训练神经网络，交通流仿真软件 SUMO 被用来生成时序车辆信息，结合统计信道模型与生成的时序车辆信息，生成了时序的信道信息。
Meanwhile, a road traffic simulation software is use to generate time seires vehicle information (e.g. position, speed, etc.) to set up time seires CSI with a statistical channel model for training the network.
%% 此外，提出了快速中断恢复算法，在追踪失效后能够减少波束扫描的次数，尽快恢复连接。
% 相比较于 *，本论文有以下几点不同：1）采用了更加完善的信道模型；2）同时预测 AoA 与 AoD；3）中断判断根据接收端的 SNR 而非角度差进行判断；4）在一个追踪周期中平均需要更少的波束测量。此外，与 * 相比使用了更实际的基于量化相移器的波束码本进行波束扫描。
Compared to \cite{Zhang2016, Va2017}, this paper differs in the following ways: 1) More realistic channel model; 2) Simultaneous prediction of AoA and AoD; 3) The outage judgment is based on the SNR of the receiver instead of the angle difference; 4) Fewer beam measurements required on average in a tracking cycle. In addition, beam search is performed more realistic than \cite{Va2017}, by using a quantized phase shifter based beam codebook.

% 内容安排

% 符号使用
The following notation will be used in this paper.
% 矩阵，向量，标量
Matrices, vectors and scalars are denoted by bold uppercase letters (e.g. $\mathbf{A}$), bold lowercase letters (e.g. $\mathbf{a}$) and lowercase letters (e.g. $a$), respectively.
% 转置，共轭转置
$(\cdot)^{T}$ denote transpose and  $(\cdot)^H$ denote conjugate transpose (Hermitian).
% 矩阵指定行、列、元素
$[\mathbf{A}]_{m,:}$, $[\mathbf{A}]_{:,n}$ and $[\mathbf{A}_{m,n}]$ denote the $m$th row, $n$th column and the $m$th row $n$th column entry of $\mathbf{A}$, respectively.
% 向量指定元素
$[\mathbf{a}]_n$ denote the $n$th entry of $\mathbf{a}$.
% 2 范数
Besides, $\Vert{\cdot}\Vert_2$ denote $\ell_2$-norm of a vector.
% 复数、实数集合
$\mathbb{C}$ denote the set of complex number and $\mathbb{R}^+$ denote the set of real positive number.
% 复高斯、包络高斯、指数分布
Complex Gaussian distribution, wrapped Gaussian distribution and exponential distribution are denoted by $\mathcal{CN}$, $\mathcal{WN}$ and $\mathcal{E}$, respectively.

\begin{figure}[htbp]
    \centerline{\input{geo}}
    \caption{Channel geometry}
    \label{geo}
\end{figure}

\section{System Model}\label{S2}

% 场景和天线数
A mmWave vehicular networks scenario including a vehicle with $M_r$ antenna as receiver and a Base Station (BS) with $M_t$ antenna as transmitter are considered. 
% 天线结构、阵元间距、赋形技术
Both of them equips with uniform linear array (ULA) of half wave interval antenna as shown in Fig.1, and adopted analog beamforming used quantitative phase shifter which connect with single analog radio frequency (RF) chain.
% 阵列响应矢量
The array response vector of a uniform linear array with $M$ half wave interval antenna is given by:
\begin{equation}
    \mathbf{a}( M,\varphi ) =\frac{1}{\sqrt{M}}\left[ 1,e^{j\pi cos( \varphi )} ,...,e^{j\pi ( M-1) cos( \varphi )}\right]^{T}
    \label{arv}
\end{equation}
where $\varphi$ is the arrival angle of the signal. When AoA of the vehicle is $\phi$ and AoD of the BS is $\theta$, the array response vectors of both are $\mathbf{a}_{r}( \phi ) =\mathbf{a}( M_{r} ,\phi )$ and $\mathbf{a}_{t}( \theta ) =\mathbf{a}( M_{t} ,\theta )$, respectively.

% 信道模型
The statistical 28 GHz mmWave channel model in \cite{Akdeniz2014} is used, which is modeled by real experimental data collected in New York City.
The narrowband time-varying $L$ subpaths channel matrix between the vehicle and BS at $n$th time step is $\mathbf{H}_{n} \in \mathbb{C}^{M_{r} \times M_{t}}$, which is given as:
\begin{equation}
    \mathbf{H}_{n} =\frac{1}{\sqrt{L}} \sum\limits ^{L}_{l=1} g_{ln}\mathbf{a}_{r}( \phi _{ln})\mathbf{a}^{H}_{t}( \theta _{ln})
    \label{cm}
\end{equation}
where $g_{ln} \in \mathbb{C}$ is complex small-scale fading gain on subpath $l$ at $n$th time step, $\phi_{ln}$ is AoA of the $l$th subpath signal received by the vehicle at $n$th time step, and $\theta_{ln}$ is AoD of the $l$th subpath signal transmitted by the BS at $n$th time step. 
$\phi_{ln} = \phi_n + \Delta \phi_{ln}$ and $\theta _{ln} =\theta _{n} +\Delta \theta _{ln}$, where $\phi_{n}$ and $\theta_{n}$ is the AoA and AoD of the cluster at $n$th time step, $\Delta \phi _{ln} \sim \mathcal{WN}( \delta ^{2}_{rn})$, and $\Delta \theta _{ln} \sim \mathcal{WN}( \delta ^{2}_{tn})$.
The complex small-scale fading gain is given by:
\begin{equation}
    g_{ln} =\overline{g}_{ln} e^{j2\pi t_{n} f_{D,max} cos( \omega _{ln})}, \overline{g}_{ln} \sim \mathcal{CN}\left( 0,10^{-0.1PL}\right)
    \label{ssfg}
\end{equation}
where $t_{n}$ is the signal transmission time at $n$th time step, $f_{D,max} ={v_{n}}/{\lambda _{c}}$ is maximum doppler shift, $v_{n}$ is the speed of vehicle at $n$th time step, $\lambda _{c}$ is the carrier wavelength, $\omega _{ln} = \phi_{ln} - \pi / 2$ is the AoA of subpath $l$ relative to the direction of vehicle at time step $n$, and $PL$ is omnidirectional path loss given in \cite{Akdeniz2014}.
Note that only the case of single cluster under line-of-sight (LOS) condition is considered in this paper.
In addition, the cluster angle depends on the geometric position of the vehicle and base station.

% 接收信号
For a transmitted signal $x_n$ from the BS, received signal $y_n$ in the vehicle at $n$th time step is:
\begin{equation}
    y_n = \mathbf{w}^H_n \mathbf{H}_n \mathbf{f}_n x_n + \mathbf{w}^H_n \mathbf{v}_n
    \label{rs}
\end{equation}
where $\mathbf{w}_n$ and $\mathbf{f}_n$ are combining vector and beamforming vector at $n$th time step, respectively. $\mathbf{v}_n$ is Gaussian noise at time step $n$ and $\mathbf{v}_n \sim \mathcal{CN}(0, \sigma^2_v \mathbf{I}_{M_r})$. 

\section{Data Generation}

% 信道矩阵
\subsection{Channel Matrix}
% 场景介绍
A road traffic simulation software named ``SUMO'' was used to generate time series information of the vehicle in the scene mentioned in Section \ref{S2}, which including a vehicle, a BS and a road with a curve as shown in Fig. \ref{scene}.
The vehicle departs from $(0, 100)$ at first time step, and arrives $(100, 0)$ at final time step.
Note that the speed of vehicle is different at each time step, that means the variation of vehicle position and beam angles is non-linear.

% 几何信息
The generated vehicle time series information is composed with position, $v_n$ and directional angle $\beta_n$ of the vehicle at each time step.
For $n$th time step, the position of vehicle is given by $(x_{rn}, y_{rn})$, $v_n$ is used to determine maximum doppler shift in \eqref{ssfg}, and $\beta_n$ is used to calculate $\phi_{ln}$ and $\omega_{ln}$.

Once the position of vehicle and BS are obtained, $\theta_n$ and $\phi_n$ can be calculated by simple geometric methods as following:
\begin{equation}
    \begin{cases}
    \theta _{n} =\arg( \Gamma _{xn} +j\Gamma _{yn})\\
    \phi _{n} =\arg( \Gamma _{xn} +j\Gamma _{yn}) -\beta _{n}
    \end{cases}
    \label{ba}
\end{equation}
where $\Gamma _{xn} =x_{rn} -x_{tn}$, $\Gamma _{yn} =y_{rn} -y_{tn} $, $(x_{tn}, y_{tn})$ are coordinates of the BS, $\beta _{n}$ is directional angle of the vehicle. 
Furthermore, $t_n = d_n / c$, $d_n = \sqrt{\Gamma_{xn}^2 + \Gamma_{yn}^2}$ is distance between the vehicle and BS at $n$th time step, and $c$ is light speed.
Now the channel matrix at each time step can be obtained from \eqref{cm}, \eqref{ssfg} and \eqref{ba}.

% 波束角度
\subsection{Beam Angles}



% 码本设计
The codebook matrix of vehicle is $\mathbf{W}$, and the codebook matrix of BS is $\mathbf{F}$. Each column of the codebook matrix represents a beam pattern, each entry in the column is phase rotation for corresponding antenna element to generate directional beam.
A discrete resolution $2log_2 M$-bit codebook is adopted, in other words, there are $2M_r$ beam patterns for the vehicle, and $M_t$ beam patterns for the BS.
% 

\begin{figure}[htbp]
    \centerline{\input{scene}}
    \caption{Scene of mmWave vehicular networks for data generation}
    \label{scene}
\end{figure}

\section{LSTM-based Beam Tracking Solution}

\begin{figure}[htbp]
    \centerline{\input{lstm}}
    \caption{Structure of network}
    \label{lstm}
\end{figure}

\section{Simulation Results and Discussion}

\section*{Acknowledgment}

Thanks, guys.

\bibliographystyle{IEEEtran}
\bibliography{references}

% \begin{thebibliography}{00}
% \bibitem{b1}
% \end{thebibliography}

\end{document}
